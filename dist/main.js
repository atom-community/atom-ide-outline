"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("atom"),t=require("zadeh"),n=require("path"),i=require("util"),o=require("fs"),r=require("assert");function s(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a=s(e),l=s(n),c=s(i),d=s(o),u=s(r),f="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},h={};Object.defineProperty(h,"__esModule",{value:!0}),h.scrollIntoView=function(e,t){const n=m(e);e.scrollIntoView(t),v(n)};var p=h.scrollIntoViewIfNeeded=function(e,t=!0){var n,i,o;const r=m(e);null!==(n=null===(i=(o=e).scrollIntoViewIfNeeded)||void 0===i?void 0:i.call(o,t))&&void 0!==n||e.scrollIntoView(t),v(r)};function m(e){let t=e;const n=new Map;for(;null!==t;)n.set(t,t.scrollTop),t=t.parentElement;return n}function v(e){e.forEach(((e,t)=>{t.scrollTop!==e&&g(t)&&(t.scrollTop=e)}))}function g(e){const t=null==e?void 0:e.style.overflow;return"hidden"===(null!=t?t:getComputedStyle(e).overflow)}h.isOverflowHidden=g;var y={};Object.defineProperty(y,"__esModule",{value:!0});var w=y.isItemVisible=function(e){if(null==e)return!1;const t=b(e);if(void 0!==t&&!E(t))return!1;const n=atom.workspace.paneContainerForItem(e);return void 0!==n&&("function"!=typeof n.isVisible||n.isVisible())};function E(e){return!(e instanceof HTMLElement)||"none"!==e.style.display&&!e.hidden&&0!==e.offsetHeight}function b(e){if(null!=e)return"function"==typeof e.getElement?e.getElement():e.element}y.isElementVisible=E,y.getItemElement=b;var P="function"==typeof WeakSet,C=Object.keys;function T(e,t){return e===t||e!=e&&t!=t}function L(e){return e.constructor===Object||null==e.constructor}function k(e){return!!e&&"function"==typeof e.then}function x(e){return!(!e||!e.$$typeof)}function M(){var e=[];return{add:function(t){e.push(t)},has:function(t){return-1!==e.indexOf(t)}}}var O=P?function(){return new WeakSet}:M;function I(e){return function(t){var n=e||t;return function(e,t,i){void 0===i&&(i=O());var o=!!e&&"object"==typeof e,r=!!t&&"object"==typeof t;if(o||r){var s=o&&i.has(e),a=r&&i.has(t);if(s||a)return s&&a;o&&i.add(e),r&&i.add(t)}return n(e,t,i)}}}var S=Function.prototype.bind.call(Function.prototype.call,Object.prototype.hasOwnProperty);function A(e,t,n,i){var o=C(e),r=o.length;if(C(t).length!==r)return!1;if(r)for(var s=void 0;r-- >0;){if("_owner"===(s=o[r])){var a=x(e),l=x(t);if((a||l)&&a!==l)return!1}if(!S(t,s)||!n(e[s],t[s],i))return!1}return!0}var j="function"==typeof Map,R="function"==typeof Set;function D(e){var t="function"==typeof e?e(n):n;function n(e,n,i){if(e===n)return!0;if(e&&n&&"object"==typeof e&&"object"==typeof n){if(L(e)&&L(n))return A(e,n,t,i);var o=Array.isArray(e),r=Array.isArray(n);return o||r?o===r&&function(e,t,n,i){var o=e.length;if(t.length!==o)return!1;for(;o-- >0;)if(!n(e[o],t[o],i))return!1;return!0}(e,n,t,i):(o=e instanceof Date,r=n instanceof Date,o||r?o===r&&T(e.getTime(),n.getTime()):(o=e instanceof RegExp,r=n instanceof RegExp,o||r?o===r&&function(e,t){return e.source===t.source&&e.global===t.global&&e.ignoreCase===t.ignoreCase&&e.multiline===t.multiline&&e.unicode===t.unicode&&e.sticky===t.sticky&&e.lastIndex===t.lastIndex}(e,n):k(e)||k(n)?e===n:j&&(o=e instanceof Map,r=n instanceof Map,o||r)?o===r&&function(e,t,n,i){var o=e.size===t.size;return o&&e.size&&e.forEach((function(e,r){o&&(o=!1,t.forEach((function(t,s){!o&&n(r,s,i)&&(o=n(e,t,i))})))})),o}(e,n,t,i):R&&(o=e instanceof Set,r=n instanceof Set,o||r)?o===r&&function(e,t,n,i){var o=e.size===t.size;return o&&e.size&&e.forEach((function(e){o&&(o=!1,t.forEach((function(t){o||(o=n(e,t,i))})))})),o}(e,n,t,i):A(e,n,t,i)))}return e!=e&&n!=n}return n}var F=D();function H(e,t){const n=document.createElement("span");n.classList.add("outline-icon"),void 0===t&&void 0!==e&&(t=e);let i="ðŸž‡";if("string"==typeof t&&t.length>0){let e;0===t.indexOf("type-")?(e=`${t}`,i=t.replace("type-","")):(e=`type-${t}`,i=t),n.classList.add(e)}return n.innerHTML=`<span>${i.substring(0,3)}</span>`,n}D((function(){return T})),D(I()),D(I(T));class B{constructor(){this.outlineList=void 0,this.pointToElementsMap=new Map,this.treeFilterer=new t.TreeFilterer,this.element=document.createElement("div"),this.element.classList.add("atom-ide-outline"),this.element.appendChild(function(){const e=document.createElement("span");e.className="outline-toolbar";const t=document.createElement("button");t.innerHTML="Reveal Cursor",t.className="btn outline-btn",t.addEventListener("click",(()=>atom.commands.dispatch(atom.views.getView(atom.workspace),"outline:reveal-cursor"))),e.appendChild(t);const n=document.createElement("button");return n.innerHTML="Show Call Hierarchy",n.className="btn outline-btn",n.addEventListener("click",(()=>atom.commands.dispatch(atom.views.getView(atom.workspace),"outline:show-call-hierarchy"))),e.appendChild(n),e}()),this.element.appendChild(this.createSearchBar()),this.outlineContent=document.createElement("div"),this.element.appendChild(this.outlineContent),this.outlineContent.classList.add("outline-content")}reset(){var e,t,n;null===(e=this.searchBarEditorDisposable)||void 0===e||e.dispose(),null===(t=this.selectCursorDisposable)||void 0===t||t.dispose(),null===(n=this.searchBarEditor)||void 0===n||n.setText("")}destroy(){this.element.remove()}getElement(){return this.element}getTitle(){return"Outline"}getIconName(){return"list-unordered"}setOutline(e,t,n){if(void 0!==this.lastEntries&&N(e,this.lastEntries))return this.pointToElementsMap.clear(),void V(this.outlineList,e,t,this.pointToElementsMap);this.lastEntries=e,this.createOutlineList(e,t,n)}createOutlineList(e,t,n){this.clearContent(),n&&this.outlineContent.appendChild(function(){const e=document.createElement("div");return e.innerHTML='<span class="large-file-mode">Large file mode</span>',e}()),this.updateSearchBar(e,t,n),this.outlineList=_(e,t,n,this.pointToElementsMap),this.outlineContent.appendChild(this.outlineList)}clearContent(){this.outlineContent.innerHTML="",void 0!==this.outlineList&&(this.outlineList.dataset.editorRootScope=""),this.lastEntries=void 0}updateSearchBar(e,t,n){var i,o;null===(i=this.searchBarEditorDisposable)||void 0===i||i.dispose();const r=e[0],s=void 0!==(null==r?void 0:r.representativeName)?"representativeName":"plainText";this.treeFilterer.setCandidates(e,s,"children"),this.searchBarEditorDisposable=null===(o=this.searchBarEditor)||void 0===o?void 0:o.onDidStopChanging((()=>this.filterOutlineTree(t,n)))}createSearchBar(){this.searchBarEditor=new e.TextEditor({mini:!0,placeholderText:"Filter"});const t=document.createElement("div");return t.classList.add("outline-searchbar"),t.appendChild(atom.views.getView(this.searchBarEditor)),t}renderLastOutlienList(){void 0!==this.outlineList&&(this.clearContent(),this.outlineContent.appendChild(this.outlineList))}filterOutlineTree(e,n){var i,o;if(!e.isAlive()||!w(e))return;const r=null===(i=this.searchBarEditor)||void 0===i?void 0:i.getText();if("string"!=typeof r)return void this.renderLastOutlienList();const s=r.trim();if(0===s.length)return void this.renderLastOutlienList();let a;try{a=this.treeFilterer.filter(s,{maxResults:100,usePathScoring:!1})}catch(i){const r=i;r.message=`Filtering failed for unkown reasons.\n${r.message}`,console.error(r),this.reset();const a=this.treeFilterer.candidates;return this.treeFilterer=new t.TreeFilterer(a),this.updateSearchBar(a,e,n),null===(o=this.searchBarEditor)||void 0===o||o.setText(s),void this.filterOutlineTree(e,n)}const l=(c=a).filter(((e,t)=>c.findIndex((t=>F(t,e)))===t));var c;if(0===l.length)return Bt("noResult");const d=_(l,e,n,this.pointToElementsMap);this.clearContent(),this.outlineContent.appendChild(d)}presentStatus(e){this.clearContent();const t=function(e){const t=document.createElement("div");t.className="status";const{title:n="",description:i=""}=e;return t.innerHTML=`<h1>${n}</h1>\n  <span>${i}</span>`,t}(e);this.outlineContent.appendChild(t)}selectAtCursorLine(e){const t=e.getLastCursor();if(!w(this))return;if(z)return void(z=!1);if(void 0!==this.focusedElms)for(const e of this.focusedElms)e.toggleAttribute("cursorOn",!1);const n=t.getBufferRow();if(this.focusedElms=this.pointToElementsMap.get(n),void 0===this.focusedElms){const e=this.pointToElementsMap.keys();let t=0;for(const i of e){if(i>=n){const e=this.pointToElementsMap.get(t);e[e.length-1].classList.add("after-border");const n=this.pointToElementsMap.get(i);this.focusedElms=[...n,...e];break}t=i}}if(void 0!==this.focusedElms){for(const e of this.focusedElms)p(e,!0),e.toggleAttribute("cursorOn",!0);this.selectCursorDisposable=e.onDidChangeCursorPosition((()=>{var e;if(void 0!==this.focusedElms)for(const e of this.focusedElms)e.toggleAttribute("cursorOn",!1);null===(e=this.selectCursorDisposable)||void 0===e||e.dispose()}))}atom.views.getView(e).focus()}}function _(e,t,n,i){const o=document.createElement("ul");o.dataset.editorRootScope=t.getRootScopeDescriptor().getScopesArray().join(" ");const r=t.getTabLength();return"number"==typeof r&&o.style.setProperty("--editor-tab-length",Math.max(r/2,2).toString(10)),$(o,e,t,n||atom.config.get("atom-ide-outline.foldInitially"),0),V(o,e,t,i),o}function N(e,t){if(e===t)return!0;{const n=e.length;if(n!==t.length)return!1;for(let i=0;i<n;i++){const n=e[i],o=t[i];if(n.representativeName!==o.representativeName||n.plainText!==o.plainText||n.kind!==o.kind||n.icon!==o.icon||!N(n.children,o.children))return!1}}return!0}function W(e){return e.children.length>=1}function $(e,t,n,i,o){var r,s;!function(e){atom.config.get("atom-ide-outline.sortEntries")&&e.sort(((e,t)=>{const n=e.startPosition.row-t.startPosition.row;return 0===n?e.startPosition.column-e.startPosition.column:n}))}(t);for(const a of t){const t=document.createElement("li"),l=document.createElement("span");if(l.innerText=null!==(s=null!==(r=a.representativeName)&&void 0!==r?r:a.plainText)&&void 0!==s?s:"",l.prepend(H(a.icon,a.kind)),t.appendChild(l),W(a)){const e=document.createElement("ul");e.style.setProperty("--indent-level",(o+1).toString(10)),e.addEventListener("click",(e=>e.stopPropagation()),{passive:!0}),t.appendChild(e);const r=U(e,i);l.prepend(r),$(e,a.children,n,i,o+1)}e.appendChild(t)}}function V(e,t,n,i,o){const r=e.children;for(let e=0,o=t.length;e<o;e++){const o=t[e],s=r[e];if(s.addEventListener("click",(()=>G(o.startPosition,n)),{passive:!0}),q(i,o.startPosition.row,s),W(o)){V(s.lastElementChild,o.children,n,i)}}}function q(e,t,n){const i=e.get(t);void 0!==i?(i.push(n),e.set(t,i)):e.set(t,[n])}let z=!1;function G(e,t){const n=atom.workspace.paneForItem(t);void 0!==n&&(n.activate(),t.getCursors()[0].setBufferPosition(e,{autoscroll:!0}),z=!0)}function U(e,t){const n=document.createElement("button");return t?(e.hidden=!0,n.classList.add("outline-fold-btn","collapsed")):n.classList.add("outline-fold-btn","expanded"),n.addEventListener("click",(t=>{e.hidden=!e.hidden,e.hidden?(n.classList.remove("expanded"),n.classList.add("collapsed")):(n.classList.remove("collapsed"),n.classList.add("expanded")),t.stopPropagation()}),{passive:!0}),n}var J={};Object.defineProperty(J,"__esModule",{value:!0});var K=J.ProviderRegistry=void 0;const Q=a.default;K=J.ProviderRegistry=class{constructor(){this.providers=[]}addProvider(e){const t=this.providers.findIndex((t=>e.priority>t.priority));return-1===t?this.providers.push(e):this.providers.splice(t,0,e),new Q.Disposable((()=>{this.removeProvider(e)}))}removeProvider(e){const t=this.providers.indexOf(e);-1!==t&&this.providers.splice(t,1)}getProviderForEditor(e){const t=e.getGrammar().scopeName;return this.findProvider(t)}getAllProvidersForEditor(e){const t=e.getGrammar().scopeName;return this.findAllProviders(t)}findProvider(e){for(const t of this.findAllProviders(e))return t;return null}*findAllProviders(e){for(const t of this.providers)null!=t.grammarScopes&&-1===t.grammarScopes.indexOf(e)||(yield t)}};var X={},Y={};Object.defineProperty(Y,"__esModule",{value:!0}),Y.getCwd=void 0;const Z=l.default,ee=c.default,te=d.default,ne=ee.promisify(te.stat);Y.getCwd=async function(e=""){var t;let n;if(e)n=e;else{const e=atom.workspace.getActivePaneItem();if(n=null===(t=null==e?void 0:e.getPath)||void 0===t?void 0:t.call(e),n){const e=atom.project.relativizePath(n)[0];if(e)return e}}try{if(n){if((await ne(n)).isDirectory())return n;n=Z.dirname(n);if((await ne(n)).isDirectory())return n}}catch(e){}return n=atom.project.getPaths()[0],n};var ie={},oe=f&&f.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ie,"__esModule",{value:!0}),ie.isPositionInRange=ie.matchRegexEndingAt=ie.wordAtPositionFromBuffer=ie.getWordFromCursorOrSelection=ie.getWordFromMouseEvent=ie.trimRange=ie.wordAtPosition=void 0;const re=a.default,se=oe(u.default);function ae(e,t,n){let i;if(n instanceof RegExp)i=n;else{const o=e.getNonWordCharacters(t).replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&");let r=`^[\t ]*$|[^\\s${o}]+`;(null==n||n.includeNonWordCharacters)&&(r+=`|[${o}]+`),i=new RegExp(r,"g")}return ce(e.getBuffer(),t,i)}function le(e,t){const n=ae(e,t);return null==n||1!==n.wordMatch.length?null:n.wordMatch[0]}function ce(e,t,n){const{row:i,column:o}=t,r=e.rangeForRow(i);let s;return e.scanInRange(n,r,(e=>{const{range:n}=e;n.start.isLessThanOrEqual(t)&&n.end.isGreaterThan(t)&&(s=e),n.end.column>o&&e.stop()})),s?{wordMatch:s.match,range:s.range}:null}ie.wordAtPosition=ae,ie.trimRange=function(e,t,n=/\S/){const i=e.getBuffer();let{start:o,end:r}=t;return i.scanInRange(n,t,(({range:e,stop:t})=>{o=e.start,t()})),i.backwardsScanInRange(n,t,(({range:e,stop:t})=>{r=e.end,t()})),new re.Range(o,r)},ie.getWordFromMouseEvent=function(e,t){const n=e.getElement().component;return se.default(n),le(e,n.screenPositionForMouseEvent(t))},ie.getWordFromCursorOrSelection=function(e){const t=e.getSelectedText();if(t&&t.length>0)return t;const n=e.getCursorScreenPosition();return le(e,n)},ie.wordAtPositionFromBuffer=ce,ie.matchRegexEndingAt=function(e,t,n){const i=e.getTextInRange([[t.row,0],t]),o=n.exec(i);return null==o?null:o[0]},ie.isPositionInRange=function(e,t){return Array.isArray(t)?t.some((t=>t.containsPoint(e))):t.containsPoint(e)};var de={};Object.defineProperty(de,"__esModule",{value:!0}),de.notifyError=void 0,de.notifyError=function(e){atom.notifications.addError(e.name,{stack:e.stack,detail:e.message})};var ue={};function fe(e,t){if(e.largeFileMode)return 1e5;const n=e.getLineCount();return n>=t?n:0}function he(e,t,n=e.getLineCount()){const i=e.getBuffer();for(let e=0,o=n;e<o;e++){const n=i.lineLengthForRow(e);if(n>t)return n}return 0}Object.defineProperty(ue,"__esModule",{value:!0}),ue.lineLengthIfLong=ue.lineCountIfLarge=ue.largeness=void 0,ue.largeness=function(e,t=atom.config.get("atom-ide-base.largeLineCount")||4e3,n=atom.config.get("atom-ide-base.longLineLength")||4e3){const i=fe(e,t);if(0!==i)return i;const o=he(e,n);return 0!==o?o:0},ue.lineCountIfLarge=fe,ue.lineLengthIfLong=he,function(e){var t=f&&f.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),n=f&&f.__exportStar||function(e,n){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||t(n,e,i)};Object.defineProperty(e,"__esModule",{value:!0}),n(Y,e),n(J,e),n(ie,e),n(de,e),n(ue,e)}(X);const pe={noEditor:{title:"Outline is unavailable.",description:"Open a text editor."},noProvider:{title:"Provider is unavailable",description:"Looks like a provider for this type of file is not available. Check if a relevant IDE language package is installed and has outline support, or try adding one from Atom's package registry (e.g.: atom-ide-javascript, atom-typescript, ide-python, ide-rust, ide-css, ide-json)."},noResult:{title:"No result was found.",description:"The Outline could not found the text you entered in the filter bar."}};var me=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},ve="object"==typeof f&&f&&f.Object===Object&&f,ge="object"==typeof self&&self&&self.Object===Object&&self,ye=ve||ge||Function("return this")(),we=ye,Ee=function(){return we.Date.now()},be=/\s/;var Pe=function(e){for(var t=e.length;t--&&be.test(e.charAt(t)););return t},Ce=/^\s+/;var Te=function(e){return e?e.slice(0,Pe(e)+1).replace(Ce,""):e},Le=ye.Symbol,ke=Le,xe=Object.prototype,Me=xe.hasOwnProperty,Oe=xe.toString,Ie=ke?ke.toStringTag:void 0;var Se=function(e){var t=Me.call(e,Ie),n=e[Ie];try{e[Ie]=void 0;var i=!0}catch(e){}var o=Oe.call(e);return i&&(t?e[Ie]=n:delete e[Ie]),o},Ae=Object.prototype.toString;var je=Se,Re=function(e){return Ae.call(e)},De=Le?Le.toStringTag:void 0;var Fe=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":De&&De in Object(e)?je(e):Re(e)},He=function(e){return null!=e&&"object"==typeof e};var Be=Te,_e=me,Ne=function(e){return"symbol"==typeof e||He(e)&&"[object Symbol]"==Fe(e)},We=/^[-+]0x[0-9a-f]+$/i,$e=/^0b[01]+$/i,Ve=/^0o[0-7]+$/i,qe=parseInt;var ze=me,Ge=Ee,Ue=function(e){if("number"==typeof e)return e;if(Ne(e))return NaN;if(_e(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=_e(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Be(e);var n=$e.test(e);return n||Ve.test(e)?qe(e.slice(2),n?2:8):We.test(e)?NaN:+e},Je=Math.max,Ke=Math.min;var Qe=function(e,t,n){var i,o,r,s,a,l,c=0,d=!1,u=!1,f=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function h(t){var n=i,r=o;return i=o=void 0,c=t,s=e.apply(r,n)}function p(e){return c=e,a=setTimeout(v,t),d?h(e):s}function m(e){var n=e-l;return void 0===l||n>=t||n<0||u&&e-c>=r}function v(){var e=Ge();if(m(e))return g(e);a=setTimeout(v,function(e){var n=t-(e-l);return u?Ke(n,r-(e-c)):n}(e))}function g(e){return a=void 0,f&&i?h(e):(i=o=void 0,s)}function y(){var e=Ge(),n=m(e);if(i=arguments,o=this,l=e,n){if(void 0===a)return p(l);if(u)return clearTimeout(a),a=setTimeout(v,t),h(l)}return void 0===a&&(a=setTimeout(v,t)),s}return t=Ue(t)||0,ze(n)&&(d=!!n.leading,r=(u="maxWait"in n)?Je(Ue(n.maxWait)||0,t):r,f="trailing"in n?!!n.trailing:f),y.cancel=function(){void 0!==a&&clearTimeout(a),c=0,i=l=o=a=void 0},y.flush=function(){return void 0===a?s:g(Ge())},y};function Xe(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)}function Ye(e,t,n,i,o){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?o.call(e,n):o?o.value=n:t.set(e,n),n}var Ze,et,tt,nt,it,ot,rt,st,at,lt,ct,dt,ut,ft,ht,pt,mt,vt,gt,yt,wt={noEditor:{title:"Call Hierarchy is unavailable.",description:"Open a text editor."},noProvider:{title:"Provider is unavailable.",description:"Looks like a provider for this type of file is not available. Check if a relevant IDE language package is installed and has call hierarchy support, or try adding one from Atom's package registry (e.g.: atom-ide-javascript, atom-typescript, ide-python, ide-rust, ide-css, ide-json)."},noResult:{title:"No result was found.",description:"Move the cursor over the function name."}};class Et extends HTMLElement{constructor({providerRegistry:t}){super(),Ze.set(this,new e.CompositeDisposable),et.set(this,void 0),tt.set(this,void 0),nt.set(this,void 0),it.set(this,void 0),ot.set(this,300),rt.set(this,void 0),this.destroyed=!1,this.getTitle=()=>"Call Hierarchy",this.getIconName=()=>"link",st.set(this,(()=>{Ye(this,it,"incoming"===Xe(this,it,"f")?"outgoing":"incoming","f"),this.setAttribute("current-type",Xe(this,it,"f")),this.showCallHierarchy()})),at.set(this,(async e=>{const t=Xe(this,rt,"f"),n=Ye(this,rt,Et.getStatus(e),"f");if("valid"===n){Xe(this,nt,"f").innerHTML="";const t=new bt(e);return Xe(this,nt,"f").appendChild(t),void await t.toggleAllItem()}if(t===n)return;Xe(this,nt,"f").innerHTML="";const i=new Pt(wt[n]);Xe(this,nt,"f").appendChild(i)})),Ye(this,tt,t,"f");const n=this.appendChild(document.createElement("div"));n.innerHTML='\n      <div class="icon icon-alignment-align">Incoming</div>\n      <div class="icon icon-alignment-aligned-to">Outgoing</div>\n    ',n.addEventListener("click",(()=>Xe(this,st,"f").call(this))),Ye(this,nt,this.appendChild(document.createElement("div")),"f"),Ye(this,it,"incoming","f"),this.setAttribute("current-type","incoming");const i=Qe(this.showCallHierarchy.bind(this),Xe(this,ot,"f"));Xe(this,Ze,"f").add(atom.workspace.observeActiveTextEditor((e=>{var t;null===(t=Xe(this,et,"f"))||void 0===t||t.dispose(),Ye(this,et,null==e?void 0:e.onDidChangeCursorPosition((t=>{i(e,t.newBufferPosition)})),"f"),this.showCallHierarchy(e)})))}static getStatus(e){return"string"==typeof e?e:e&&0!==e.data.length?"valid":"noResult"}async showCallHierarchy(e,t){if(this.destroyed)return;const n=null!=e?e:atom.workspace.getActiveTextEditor();if(!n)return void await Xe(this,at,"f").call(this,"noEditor");const i=null!=t?t:n.getCursorBufferPosition(),o=Xe(this,tt,"f").getProviderForEditor(n);o?await Xe(this,at,"f").call(this,await("incoming"===Xe(this,it,"f")?o.getIncomingCallHierarchy(n,i):o.getOutgoingCallHierarchy(n,i))):await Xe(this,at,"f").call(this,"noProvider")}destroy(){var e;this.innerHTML="",null===(e=Xe(this,et,"f"))||void 0===e||e.dispose(),Xe(this,Ze,"f").dispose(),this.destroyed=!0}}Ze=new WeakMap,et=new WeakMap,tt=new WeakMap,nt=new WeakMap,it=new WeakMap,ot=new WeakMap,rt=new WeakMap,st=new WeakMap,at=new WeakMap,customElements.define("atom-ide-outline-call-hierarchy-view",Et);class bt extends HTMLElement{constructor(e){super(),lt.set(this,void 0),ct.set(this,300),dt.set(this,(({path:e,range:{start:{row:t,column:n}},selectionRange:i})=>{const o=atom.workspace.getActiveTextEditor();(null==o?void 0:o.getPath())===e?(o.setCursorBufferPosition([t,n]),o.scrollToBufferPosition([t,n],{center:!0}),o.setSelectedBufferRange(i)):atom.workspace.open(e,{initialLine:t,initialColumn:n,searchAllPanes:!0,activatePane:!0,activateItem:!0}).then((e=>null==e?void 0:e.setSelectedBufferRange(i)))})),Ye(this,lt,e,"f"),bt.isEmpty(Xe(this,lt,"f"))?this.innerHTML='<div class="call-hierarchy-no-data">No result was found.</div>':this.append(...Xe(this,lt,"f").data.map(((e,t)=>{var n,i,o;const r=document.createElement("div");r.setAttribute("title",e.path),r.innerHTML=`\n        <div class="icon icon-chevron-right">\n          <div>\n            <span>${Ct(e.name)}</span>\n            <span class="detail">${Ct(e.detail?` - ${e.detail}`:"")}</span>\n            ${e.tags.map((e=>`<span class="tag-${Ct(e)}">${Ct(e)}</span>`)).join("")}\n          </div>\n        </div>\n        `,null===(n=r.querySelector(":scope>div>div"))||void 0===n||n.insertAdjacentElement("afterbegin",H(null!==(i=e.icon)&&void 0!==i?i:void 0,void 0));let s=!1;return null===(o=r.querySelector(":scope>div"))||void 0===o||o.addEventListener("click",(e=>{e.stopPropagation(),s&&Xe(this,lt,"f")?Xe(this,dt,"f").call(this,Xe(this,lt,"f").data[t]):(this.toggleItemAt(t),window.setTimeout((()=>s=!1),Xe(this,ct,"f")),s=!0)}),!1),r})))}static isEmpty(e){return!e||0==e.data.length}async toggleItemAt(e){var t;const n=this.querySelectorAll(":scope>div")[e],i=n.querySelector(":scope>div"),o=n.querySelector("atom-ide-outline-call-hierarchy-item");o?"none"!==o.style.display?(o.style.display="none",null==i||i.classList.replace("icon-chevron-down","icon-chevron-right")):(o.style.display="",null==i||i.classList.replace("icon-chevron-right","icon-chevron-down")):(n.appendChild(new bt(await(null===(t=Xe(this,lt,"f"))||void 0===t?void 0:t.itemAt(e)))),null==i||i.classList.replace("icon-chevron-right","icon-chevron-down"))}async toggleAllItem(){var e,t;const n=null!==(t=null===(e=Xe(this,lt,"f"))||void 0===e?void 0:e.data.length)&&void 0!==t?t:0;await Promise.all([...Array(n).keys()].map((e=>this.toggleItemAt(e))))}}lt=new WeakMap,ct=new WeakMap,dt=new WeakMap,customElements.define("atom-ide-outline-call-hierarchy-item",bt);class Pt extends HTMLElement{constructor({title:e,description:t}){super(),this.innerHTML=`\n      <h1>${Ct(e)}</h1>\n      <span>${Ct(t)}</span>\n    `}}function Ct(e){return e.replace(/["&'<>`]/g,(e=>({"&":"&amp;","'":"&#x27;","`":"&#x60;",'"':"&quot;","<":"&lt;",">":"&gt;"}[e])))}customElements.define("atom-ide-outline-call-hierarchy-status-item",Pt);class Tt{constructor({createItem:e}){ut.add(this),pt.set(this,void 0),Ye(this,pt,e,"f")}toggle(){const{state:e,targetPane:t}=Xe(this,ut,"m",yt).call(this);"hidden"===e?Xe(this,ut,"m",mt).call(this,{targetPane:t}):"noItem"===e?Xe(this,ut,"m",vt).call(this,{targetPane:t}):Xe(this,ut,"m",gt).call(this,{targetPane:t})}show(){const{state:e,targetPane:t}=Xe(this,ut,"m",yt).call(this);"hidden"===e?Xe(this,ut,"m",mt).call(this,{targetPane:t}):"noItem"===e&&Xe(this,ut,"m",vt).call(this,{targetPane:t})}delete(){const e=this.item&&atom.workspace.paneForItem(this.item);e&&Xe(this,ut,"m",gt).call(this,{targetPane:e})}}ft=Tt,pt=new WeakMap,ut=new WeakSet,ht=function(){return atom.workspace.getRightDock()},mt=function({targetPane:e}){this.item&&e.activateItem(this.item);const t=atom.workspace.getPaneContainers().find((t=>t.getPanes().includes(e)));t&&"show"in t&&t.show()},vt=function({targetPane:e}){this.item=Xe(this,pt,"f").call(this),e.addItem(this.item),e.activateItem(this.item),Xe(Tt,ft,"m",ht).call(Tt).show()},gt=function({targetPane:e}){this.item&&e.destroyItem(this.item)},yt=function(){const e=this.item&&atom.workspace.paneForItem(this.item);return e?e.getActiveItem()===this.item&&atom.workspace.getVisiblePanes().includes(e)?{state:"visible",targetPane:e}:{state:"hidden",targetPane:e}:{state:"noItem",targetPane:Xe(Tt,ft,"m",ht).call(Tt).getActivePane()}};const Lt=new K,kt=new e.CompositeDisposable,xt=new Tt({createItem:()=>new Et({providerRegistry:Lt})});var Mt={initialDisplay:{title:"Initial Outline Display",description:"Show outline initially aftern atom loads",type:"boolean",default:!0},sortEntries:{title:"Sort entries based on the line number",description:"This option sorts the entries based on where they appear in the code.",type:"boolean",default:!0},foldInitially:{title:"Fold the entries initially",description:"If enabled, the outline entries are folded initially. This is enabled automatically in large file mode.",type:"boolean",default:!1}};const Ot=new e.CompositeDisposable;let It;const St=new K;let At;async function jt(t){if(void 0===t)return;null==At||At.dispose(),At=new e.CompositeDisposable,await Ht(t);const n=X.largeness(t),i=Math.max(n/4,300),o=Qe(Ft,i);At.add(t.onDidStopChanging((async()=>{await o(t)})),t.onDidDestroy((()=>{Bt("noEditor")})))}function Rt(){const e=atom.workspace.getActiveTextEditor();void 0!==e&&void 0!==It&&It.selectAtCursorLine(e)}async function Dt(){void 0===It&&(It=new B);const e=atom.workspace.paneForItem(It);if(e)return void await e.destroyItem(It);const t=atom.workspace.getRightDock(),[n]=t.getPanes();n.addItem(It),n.activateItem(It),t.show();try{await jt(atom.workspace.getActiveTextEditor())}catch(e){X.notifyError(e)}}function Ft(e=atom.workspace.getActiveTextEditor()){if(w(It))return Ht(e)}async function Ht(e=atom.workspace.getActiveTextEditor()){var t;if(void 0===It?It=new B:It.reset(),void 0===e)return Bt("noEditor");const n=St.getProviderForEditor(e);if(!n)return Bt("noProvider");const i=await n.getOutline(e);It.setOutline(null!==(t=null==i?void 0:i.outlineTrees)&&void 0!==t?t:[],e,Boolean(X.largeness(e)))}function Bt(e){null==It||It.presentStatus(pe[e])}exports.activate=function(){kt.add(atom.commands.add("atom-workspace","outline:toggle-call-hierarchy",(()=>xt.toggle())),atom.commands.add("atom-workspace","outline:show-call-hierarchy",(()=>xt.show()))),Ot.add(atom.commands.add("atom-workspace","outline:toggle",Dt),atom.commands.add("atom-workspace","outline:reveal-cursor",Rt)),Ot.add(atom.workspace.onDidChangeActiveTextEditor(jt)),atom.config.get("atom-ide-outline.initialDisplay")&&Dt().catch((e=>{X.notifyError(e)}))},exports.config=Mt,exports.consumeCallHierarchyProvider=function(e){var t;const n=Lt.addProvider(e);return kt.add(n),null===(t=xt.item)||void 0===t||t.showCallHierarchy(),n},exports.consumeOutlineProvider=async function(e){Ot.add(St.addProvider(e)),await Ht()},exports.deactivate=function(){kt.dispose(),xt.delete(),null==At||At.dispose(),Ot.dispose(),null==It||It.destroy(),It=void 0},exports.getOutline=Ht,exports.outlineProviderRegistry=St,exports.revealCursor=Rt,exports.setStatus=Bt,exports.statuses=pe,exports.toggleOutlineView=Dt;
//# sourceMappingURL=main.js.map
