{"version":3,"file":"main.js","sources":["../src/utils.ts","../src/outlineView.ts","../node_modules/atom-ide-base/src-commons-atom/ProviderRegistry.ts","../src/statuses.ts","../node_modules/lodash/isObject.js","../node_modules/lodash/_freeGlobal.js","../node_modules/lodash/_root.js","../node_modules/lodash/now.js","../node_modules/lodash/_trimmedEndIndex.js","../node_modules/lodash/_baseTrim.js","../node_modules/lodash/_Symbol.js","../node_modules/lodash/_getRawTag.js","../node_modules/lodash/_objectToString.js","../node_modules/lodash/_baseGetTag.js","../node_modules/lodash/isObjectLike.js","../node_modules/lodash/isSymbol.js","../node_modules/lodash/toNumber.js","../node_modules/lodash/debounce.js","../src/main.ts"],"sourcesContent":["import type { Dock } from \"atom\"\n\n/** A function to detect if an item (view) is visible in Atom */\nexport function isItemVisible(item: object) {\n  const paneContainer = atom.workspace.paneContainerForItem(item)\n  if (paneContainer === undefined) {\n    return false\n  }\n  if (typeof (paneContainer as any).isVisible === \"function\") {\n    return (paneContainer as Dock).isVisible()\n  } else {\n    return true\n  }\n}\n\n/** Throw an Error using atom notifications */\nexport function notifyError(e: Error) {\n  atom.notifications.addError(e.name, {\n    stack: e.stack,\n    detail: e.message,\n  })\n}\n","/* eslint-disable @typescript-eslint/no-non-null-assertion */\nimport { TextEditor, CursorPositionChangedEvent } from \"atom\"\nimport { OutlineTree } from \"atom-ide-base\"\nimport { isItemVisible } from \"./utils\"\n\nexport class OutlineView {\n  public element: HTMLDivElement\n  private pointToElementsMap = new Map<number, Array<HTMLLIElement>>() // TODO Point to element\n  private focusedElms: HTMLElement[] | undefined // cache for focused elements\n\n  constructor() {\n    this.element = document.createElement(\"div\")\n    this.element.classList.add(\"outline-view\")\n  }\n\n  destroy() {\n    this.element.remove()\n  }\n\n  getElement() {\n    return this.element\n  }\n\n  getTitle() {\n    return \"Outline\"\n  }\n\n  getIconName() {\n    return \"list-unordered\"\n  }\n\n  setOutline(outlineTree: OutlineTree[], editor: TextEditor, isLarge: boolean) {\n    const outlineViewElement = this.clearOutline()\n    outlineViewElement.dataset.editorRootScope = editor.getRootScopeDescriptor().getScopesArray().join(\" \")\n\n    if (isLarge) {\n      const largeFileElement = document.createElement(\"div\")\n      largeFileElement.innerHTML = `\n        <span style = \"\n          font-size: var(--editor-font-size);\n          font-family: var(--editor-font-family);\n          line-height: var(--editor-line-height);\n          color: #71844c;\n        \"\n        >Large file mode</span>\n      `\n      outlineViewElement.appendChild(largeFileElement)\n    }\n\n    const outlineRoot = document.createElement(\"ul\")\n    const tabLength = editor.getTabLength()\n    if (typeof tabLength === \"number\") {\n      outlineRoot.style.setProperty(\"--editor-tab-length\", Math.max(tabLength / 2, 2).toString(10))\n    }\n    addOutlineEntries(\n      outlineRoot,\n      outlineTree,\n      editor,\n      this.pointToElementsMap,\n      /* foldInItially */ isLarge || atom.config.get(\"atom-ide-outline.foldInitially\")\n    )\n    outlineViewElement.appendChild(outlineRoot)\n  }\n\n  clearOutline() {\n    const outlineViewElement = this.getElement()\n    outlineViewElement.innerHTML = \"\"\n    outlineViewElement.dataset.editorRootScope = \"\"\n    return outlineViewElement\n  }\n\n  presentStatus(status: { title: string; description: string }) {\n    this.clearOutline()\n\n    const statusElement = status && generateStatusElement(status)\n\n    if (statusElement) {\n      const outlineViewElement = this.getElement()\n      outlineViewElement.appendChild(statusElement)\n    }\n  }\n\n  // callback for scrolling and highlighting the element that the cursor is on\n  selectAtCursorLine(newBufferPosition: CursorPositionChangedEvent[\"newBufferPosition\"]) {\n    // skip if not visible\n    if (!this.isVisible()) {\n      return\n    }\n\n    if (clicked) {\n      // do not scroll when the cursor has moved to a click on the outline entry\n      clicked = false\n      return\n    }\n\n    // TIME: ~0.2-0.3ms\n    // TODO use range of start and end instead of just the line number\n\n    // remove old cursorOn attribue\n    if (this.focusedElms !== undefined) {\n      for (const elm of this.focusedElms) {\n        elm.toggleAttribute(\"cursorOn\", false)\n      }\n    }\n\n    // add new cursorOn attribue\n    const cursorPoint = newBufferPosition.row\n    this.focusedElms = this.pointToElementsMap.get(cursorPoint)\n\n    if (this.focusedElms !== undefined) {\n      for (const elm of this.focusedElms) {\n        elm.toggleAttribute(\"cursorOn\", true)\n        elm.scrollIntoView({\n          block: \"center\", // scroll until the entry is in the center of outline\n        })\n      }\n    }\n  }\n\n  isVisible() {\n    return isItemVisible(this)\n  }\n}\n\nfunction generateStatusElement(status: { title: string; description: string }) {\n  const element = document.createElement(\"div\")\n  element.className = \"status\"\n\n  const { title = \"\", description = \"\" } = status\n  element.innerHTML = `<h1>${title}</h1>\n  <span>${description}</span>`\n\n  return element\n}\n\nlet clicked: boolean = false // used to prevent scrolling in the outline list when an entry is clicked\n\nfunction addOutlineEntries(\n  parent: HTMLUListElement,\n  entries: OutlineTree[],\n  editor: TextEditor,\n  pointToElementsMap: Map<number, Array<HTMLLIElement>>,\n  isLarge: boolean,\n  level = 0\n) {\n  // NOTE: this function is called multiple times with each update in an editor!\n  // a few of the calls is slow ~1-100ms\n\n  // sort entries\n  // TIME 0.1ms\n  if (atom.config.get(\"atom-ide-outline.sortEntries\")) {\n    entries.sort((e1: OutlineTree, e2: OutlineTree) => {\n      const rowCompare = e1.startPosition.row - e2.startPosition.row\n      if (rowCompare === 0) {\n        // compare based on column if on the same row\n        return e1.startPosition.column - e1.startPosition.column\n      }\n      return rowCompare\n    })\n  }\n\n  for (const item of entries) {\n    const symbol = document.createElement(\"li\")\n\n    // symbol.setAttribute(\"level\", `${level}`); // store level in the element\n\n    // Hold an entry in a dedicated element to prevent hover conflicts - hover over an <li> tag would be cought by a parent <li>\n    // TIME: ~0-0.1ms\n    const labelElement = document.createElement(\"span\")\n    labelElement.innerText = (item.representativeName || item.plainText) ?? \"\"\n\n    labelElement.prepend(/* iconElement */ getIcon(item?.icon, item?.kind))\n\n    symbol.appendChild(labelElement)\n\n    // update start position => elements map\n    // TIME: 0-0.2ms\n    const elms = pointToElementsMap.get(item.startPosition.row)\n    if (elms !== undefined) {\n      elms.push(symbol)\n      pointToElementsMap.set(item.startPosition.row, elms)\n    } else {\n      pointToElementsMap.set(item.startPosition.row, [symbol])\n    }\n\n    // Cursor reposition on click\n    // TIME: 0-0.1ms\n    symbol.addEventListener(\n      \"click\",\n      () => {\n        const editorPane = atom.workspace.paneForItem(editor)\n        if (!editorPane) {\n          return\n        }\n        editorPane.activate()\n\n        editor.getCursors()[0].setBufferPosition(item.startPosition, {\n          autoscroll: true,\n        })\n\n        clicked = true\n      },\n      { passive: true }\n    )\n\n    if (/* hasChildren */ item.children != null && item.children[0] != null) {\n      // create Child elements\n      // TIME 0-0.2ms\n      const childrenList = document.createElement(\"ul\")\n      childrenList.style.setProperty(\"--indent-level\", (level + 1).toString(10))\n      childrenList.addEventListener(\"click\", (event) => event.stopPropagation(), { passive: true })\n      symbol.appendChild(childrenList)\n\n      // fold Button\n      const foldButton = createFoldButton(childrenList, isLarge)\n      labelElement.prepend(foldButton)\n\n      // add children to outline\n      // TIME: last one of each batch is slower 0-20ms\n      addOutlineEntries(childrenList, item.children, editor, pointToElementsMap, isLarge, level + 1)\n    }\n\n    // TIME: <0.1ms\n    parent.appendChild(symbol)\n  }\n}\n\nfunction getIcon(iconType?: string, kindType?: string) {\n  // LSP specification: https://microsoft.github.io/language-server-protocol/specifications/specification-current/#textDocument_documentSymbol\n  // atom-languageclient mapping: https://github.com/atom/atom-languageclient/blob/485bb9d706b422456640c9070eee456ef2cf09c0/lib/adapters/outline-view-adapter.ts#L270\n\n  const iconElement = document.createElement(\"span\")\n  iconElement.classList.add(\"outline-icon\")\n\n  // if iconType given instead\n  if (kindType == undefined && iconType != undefined) {\n    kindType = iconType\n  }\n\n  let type: string = \"ðŸž‡\"\n  if (typeof kindType === \"string\" && kindType.length > 0) {\n    let kindClass: string\n    // hasKind\n    if (kindType.indexOf(\"type-\") === 0) {\n      // supplied with type-...\n      kindClass = `${kindType}`\n      type = kindType.replace(\"type-\", \"\")\n    } else {\n      // supplied without type-\n      kindClass = `type-${kindType}`\n      type = kindType\n    }\n    iconElement.classList.add(kindClass)\n  }\n\n  iconElement.innerHTML = `<span>${type.substring(0, 3)}</span>`\n\n  return iconElement\n}\n\nfunction createFoldButton(childrenList: HTMLUListElement, foldInitially: boolean) {\n  // TIME: ~0.1-0.5ms\n  // fold button\n  const foldButton = document.createElement(\"button\")\n\n  if (foldInitially) {\n    // collapse in large files by default\n    childrenList.hidden = true\n    foldButton.classList.add(\"outline-fold-btn\", \"collapsed\")\n  } else {\n    foldButton.classList.add(\"outline-fold-btn\", \"expanded\")\n  }\n\n  // fold listener\n  foldButton.addEventListener(\n    \"click\",\n    (event) => {\n      childrenList.hidden = !childrenList.hidden\n      if (childrenList.hidden) {\n        foldButton.classList.remove(\"expanded\")\n        foldButton.classList.add(\"collapsed\")\n      } else {\n        foldButton.classList.remove(\"collapsed\")\n        foldButton.classList.add(\"expanded\")\n      }\n      event.stopPropagation()\n    },\n    { passive: true }\n  )\n  return foldButton\n}\n","import { Disposable, TextEditor } from \"atom\"\nimport { Provider as ProviderTypes, BusySignalProvider, FindReferencesProvider } from \"../types-packages/main.d\"\n\nexport class ProviderRegistry<Provider extends Exclude<ProviderTypes, BusySignalProvider | FindReferencesProvider>> {\n  private providers: Array<Provider>\n\n  constructor() {\n    this.providers = []\n  }\n\n  addProvider(provider: Provider): Disposable {\n    const index = this.providers.findIndex((p) => provider.priority > p.priority)\n    if (index === -1) {\n      this.providers.push(provider)\n    } else {\n      this.providers.splice(index, 0, provider)\n    }\n    return new Disposable(() => {\n      this.removeProvider(provider)\n    })\n  }\n\n  removeProvider(provider: Provider): void {\n    const index = this.providers.indexOf(provider)\n    if (index !== -1) {\n      this.providers.splice(index, 1)\n    }\n  }\n\n  // TODO deprecate since there can be N providers.\n  getProviderForEditor(editor: TextEditor): Provider | null {\n    const grammar = editor.getGrammar().scopeName\n    return this.findProvider(grammar)\n  }\n\n  // TODO create an ordering or priority aware util to prefer instead.\n  getAllProvidersForEditor(editor: TextEditor): Iterable<Provider> {\n    const grammar = editor.getGrammar().scopeName\n    return this.findAllProviders(grammar)\n  }\n\n  findProvider(grammar: string): Provider | null {\n    for (const provider of this.findAllProviders(grammar)) {\n      return provider\n    }\n    return null\n  }\n\n  /**\n   * Iterates over all providers matching the grammar, in priority order.\n   */\n  *findAllProviders(grammar: string): Iterable<Provider> {\n    for (const provider of this.providers) {\n      if (provider.grammarScopes == null || provider.grammarScopes.indexOf(grammar) !== -1) {\n        yield provider\n      }\n    }\n  }\n}\n","export const statuses = {\n  noEditor: {\n    title: \"Outline is unavailable.\",\n    description: \"Open a text editor.\",\n  },\n  noProvider: {\n    title: \"Provider is unavailable\",\n    description:\n      \"Looks like a provider for this type of file is not available. Check if a relevant IDE language package is installed and has outline support, or try adding one from Atom's package registry (e.g.: atom-ide-javascript, atom-typescript, ide-python, ide-rust, ide-css, ide-json).\",\n  },\n}\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nmodule.exports = isObject;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n","var root = require('./_root');\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\nmodule.exports = now;\n","/** Used to match a single whitespace character. */\nvar reWhitespace = /\\s/;\n\n/**\n * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace\n * character of `string`.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {number} Returns the index of the last non-whitespace character.\n */\nfunction trimmedEndIndex(string) {\n  var index = string.length;\n\n  while (index-- && reWhitespace.test(string.charAt(index))) {}\n  return index;\n}\n\nmodule.exports = trimmedEndIndex;\n","var trimmedEndIndex = require('./_trimmedEndIndex');\n\n/** Used to match leading whitespace. */\nvar reTrimStart = /^\\s+/;\n\n/**\n * The base implementation of `_.trim`.\n *\n * @private\n * @param {string} string The string to trim.\n * @returns {string} Returns the trimmed string.\n */\nfunction baseTrim(string) {\n  return string\n    ? string.slice(0, trimmedEndIndex(string) + 1).replace(reTrimStart, '')\n    : string;\n}\n\nmodule.exports = baseTrim;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n","var Symbol = require('./_Symbol');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n","var Symbol = require('./_Symbol'),\n    getRawTag = require('./_getRawTag'),\n    objectToString = require('./_objectToString');\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nmodule.exports = isSymbol;\n","var baseTrim = require('./_baseTrim'),\n    isObject = require('./isObject'),\n    isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = baseTrim(value);\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = toNumber;\n","var isObject = require('./isObject'),\n    now = require('./now'),\n    toNumber = require('./toNumber');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        clearTimeout(timerId);\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nmodule.exports = debounce;\n","import { CompositeDisposable, TextEditor } from \"atom\"\nimport { OutlineView } from \"./outlineView\"\nimport { OutlineProvider } from \"atom-ide-base\"\nimport { ProviderRegistry } from \"atom-ide-base/commons-atom/ProviderRegistry\"\nimport { notifyError } from \"./utils\"\n\nexport { statuses } from \"./statuses\" // for spec\nimport { statuses } from \"./statuses\"\nimport debounce from \"lodash/debounce\"\n\nconst subscriptions = new CompositeDisposable()\n\nlet view: OutlineView | undefined\nexport const outlineProviderRegistry = new ProviderRegistry<OutlineProvider>()\n\n// let busySignalProvider: BusySignalProvider | undefined // service might be consumed late\n\nexport function activate() {\n  addCommands()\n  addObservers()\n  if (atom.config.get(\"atom-ide-outline.initialDisplay\")) {\n    // initially show outline pane\n    toggleOutlineView().catch((e) => {\n      notifyError(e)\n    })\n  }\n}\n\nexport function deactivate() {\n  onDidCompositeDisposable?.dispose?.()\n  subscriptions.dispose()\n  view?.destroy()\n  view = undefined\n}\n\n// export function consumeSignal(registry: BusySignalRegistry) {\n//   busySignalProvider = registry.create()\n//   subscriptions.add(busySignalProvider)\n// }\n\nexport async function consumeOutlineProvider(provider: OutlineProvider) {\n  subscriptions.add(/*  providerRegistryEntry */ outlineProviderRegistry.addProvider(provider))\n\n  // Generate (try) an outline after obtaining a provider\n  await getOutline()\n}\n\nfunction addCommands() {\n  subscriptions.add(\n    /* outlineToggle */ atom.commands.add(\"atom-workspace\", \"outline:toggle\", toggleOutlineView),\n    /* revealCursor */ atom.commands.add(\"atom-workspace\", \"outline:reveal-cursor\", revealCursor)\n  )\n}\n\nconst longLineLength = atom.config.get(\"linter-ui-default.longLineLength\") || 4000\nconst largeFileLineCount = atom.config.get(\"linter-ui-default.largeFileLineCount\") / 6 || 3000 // minimum number of lines to trigger large file optimizations\nfunction lineCountIfLarge(editor: TextEditor) {\n  // @ts-ignore\n  if (editor.largeFileMode) {\n    return 20000\n  }\n  const lineCount = editor.getLineCount()\n  if (lineCount >= largeFileLineCount) {\n    return lineCount\n  } else {\n    const buffer = editor.getBuffer()\n    for (let i = 0, len = lineCount; i < len; i++) {\n      if (buffer.lineLengthForRow(i) > longLineLength) {\n        return longLineLength\n      }\n    }\n    return 0 // small file\n  }\n}\n\n// disposables returned inside the oberservers\nlet onDidCompositeDisposable: CompositeDisposable | null\n\nfunction addObservers() {\n  onDidCompositeDisposable = new CompositeDisposable()\n  const activeTextEditorObserver = atom.workspace.observeActiveTextEditor(editorChanged)\n  subscriptions.add(activeTextEditorObserver)\n}\n\nasync function editorChanged(editor?: TextEditor) {\n  if (editor === undefined) {\n    return\n  }\n  // dispose the old subscriptions\n  onDidCompositeDisposable?.dispose?.()\n\n  await getOutline(editor) // initial outline\n\n  const lineCount = lineCountIfLarge(editor as TextEditor)\n  // How long to wait for the new changes before updating the outline.\n  // A high number will increase the responsiveness of the text editor in large files.\n  const updateDebounceTime = Math.max(lineCount / 5, 300) // 1/5 of the line count\n\n  const doubouncedGetOutline = debounce(getOutline as (textEditor: TextEditor) => Promise<void>, updateDebounceTime)\n\n  onDidCompositeDisposable!.add(\n    // update the outline if editor stops changing\n    editor.onDidStopChanging(async () => {\n      await doubouncedGetOutline(editor)\n    }),\n\n    // clean up if the editor editor is closed\n    editor.onDidDestroy(() => {\n      setStatus(\"noEditor\")\n    })\n  )\n}\n\nexport function revealCursor() {\n  const editor = atom.workspace.getActiveTextEditor()\n  if (editor === undefined) {\n    return\n  }\n\n  // following cursor disposable\n  if (view !== undefined) {\n    view.selectAtCursorLine(editor.getCursorBufferPosition())\n  }\n}\n\nexport async function toggleOutlineView() {\n  if (view === undefined) {\n    view = new OutlineView() // create outline pane\n  }\n  const outlinePane = atom.workspace.paneForItem(view)\n  if (outlinePane) {\n    outlinePane.destroyItem(view)\n    return\n  }\n\n  const rightDock = atom.workspace.getRightDock()\n  const [pane] = rightDock.getPanes()\n\n  pane.addItem(view)\n  pane.activateItem(view)\n\n  rightDock.show()\n\n  // Trigger an editor change whenever an outline is toggeled.\n  try {\n    await editorChanged(atom.workspace.getActiveTextEditor())\n  } catch (e) {\n    notifyError(e)\n  }\n}\n\nexport async function getOutline(editor = atom.workspace.getActiveTextEditor()) {\n  if (view === undefined) {\n    view = new OutlineView() // create outline pane\n  }\n  // if outline is not visible return\n  if (!view.isVisible()) {\n    return\n  }\n  // editor\n  if (editor === undefined) {\n    return setStatus(\"noEditor\")\n  }\n\n  // provider\n  const provider = outlineProviderRegistry.getProviderForEditor(editor)\n\n  if (!provider) {\n    return setStatus(\"noProvider\")\n  }\n\n  // const target = editor.getPath()\n\n  // const busySignalID = `Outline: ${target}`\n  // // @ts-ignore\n  // busySignalProvider?.add(busySignalID, { onlyForFile: target })\n\n  const outline = await provider.getOutline(editor)\n  view.setOutline(outline?.outlineTrees ?? [], editor, Boolean(lineCountIfLarge(editor as TextEditor)))\n\n  // busySignalProvider?.remove(busySignalID)\n}\n\nexport function setStatus(id: \"noEditor\" | \"noProvider\") {\n  view?.presentStatus(statuses[id])\n}\n\nexport { default as config } from \"./config.json\"\n"],"names":["notifyError","e","atom","notifications","addError","name","stack","detail","message","OutlineView","[object Object]","this","Map","element","document","createElement","classList","add","remove","outlineTree","editor","isLarge","outlineViewElement","clearOutline","dataset","editorRootScope","getRootScopeDescriptor","getScopesArray","join","largeFileElement","innerHTML","appendChild","outlineRoot","tabLength","getTabLength","style","setProperty","Math","max","toString","addOutlineEntries","pointToElementsMap","config","get","getElement","status","statusElement","className","title","description","generateStatusElement","newBufferPosition","isVisible","clicked","undefined","focusedElms","elm","toggleAttribute","cursorPoint","row","scrollIntoView","block","item","paneContainer","workspace","paneContainerForItem","isItemVisible","parent","entries","level","sort","e1","e2","rowCompare","startPosition","column","symbol","labelElement","innerText","representativeName","plainText","prepend","getIcon","icon","kind","elms","push","set","addEventListener","editorPane","paneForItem","activate","getCursors","setBufferPosition","autoscroll","passive","children","childrenList","event","stopPropagation","foldButton","createFoldButton","iconType","kindType","iconElement","type","length","kindClass","indexOf","replace","substring","foldInitially","hidden","exports","providers","provider","index","findIndex","p","priority","splice","atom_1","removeProvider","grammar","getGrammar","scopeName","findProvider","findAllProviders","grammarScopes","statuses","noEditor","noProvider","value","global","Object","freeSelf","self","freeGlobal","Function","root","Date","now","reWhitespace","string","test","charAt","reTrimStart","slice","trimmedEndIndex","Symbol","objectProto","prototype","hasOwnProperty","nativeObjectToString","symToStringTag","toStringTag","isOwn","call","tag","unmasked","result","getRawTag","objectToString","isObjectLike","baseGetTag","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","parseInt","isSymbol","isObject","other","valueOf","baseTrim","isBinary","nativeMax","nativeMin","min","func","wait","options","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","leading","maxing","trailing","TypeError","invokeFunc","time","args","thisArg","apply","leadingEdge","setTimeout","timerExpired","shouldInvoke","timeSinceLastCall","trailingEdge","timeWaiting","remainingWait","debounced","isInvoking","arguments","clearTimeout","toNumber","cancel","flush","subscriptions","CompositeDisposable","view","outlineProviderRegistry","ProviderRegistry","longLineLength","largeFileLineCount","lineCountIfLarge","largeFileMode","lineCount","getLineCount","buffer","getBuffer","i","len","lineLengthForRow","onDidCompositeDisposable","async","editorChanged","dispose","getOutline","updateDebounceTime","doubouncedGetOutline","debounce","onDidStopChanging","onDidDestroy","setStatus","revealCursor","getActiveTextEditor","selectAtCursorLine","getCursorBufferPosition","toggleOutlineView","outlinePane","destroyItem","rightDock","getRightDock","pane","getPanes","addItem","activateItem","show","getProviderForEditor","outline","setOutline","outlineTrees","Boolean","id","presentStatus","commands","activeTextEditorObserver","observeActiveTextEditor","addObservers","catch","addProvider","destroy"],"mappings":"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"}